//>>built
define("net/apachegui/GlobalTree",["../../dojo/_base/declare","dojo/request","dojo/dom","net/apachegui/ConfigurationTree","dojo/dom-construct"],function(e,f,g,h,k){e("net.apachegui.GlobalTree",null,{initialized:!1,configTree:null,checkModifiedTimes:!0,lastModifiedTimes:[],init:function(){!1===this.initialized&&(this.buildGlobalTree(),this.initLastModifiedTimes(),this.launchLastModifiedUpdateInterval(),this.initialized=!0)},loadGlobalTreeJSON:function(a){f.get("../web/GlobalTree",{query:{option:"getGlobalTree"},
handleAs:"json",preventCache:!0,sync:!1}).response.then(function(b){a(b.data.tree)})},buildGlobalTree:function(){var a=this;this.configTree=new h({id:"global_tree",loadTreeJSON:this.loadGlobalTreeJSON});this.configTree.startup();k.place(this.configTree.domNode,g.byId("global_tree_container"),"last");this.configTree.on("beforeAddLine",function(b,c){a.checkModifiedTimes=!1});this.configTree.on("afterAddLine",function(b,c){a.refreshModifiedTimes()});this.configTree.on("beforeEditLine",function(b,c){a.checkModifiedTimes=
!1});this.configTree.on("afterEditLine",function(b,c){a.refreshModifiedTimes()});this.configTree.on("beforeDeleteLine",function(b,c){a.checkModifiedTimes=!1});this.configTree.on("afterDeleteLine",function(b,c){a.refreshModifiedTimes()})},initLastModifiedTimes:function(){var a=this;this.getLastModifiedTimes(function(b){a.lastModifiedTimes=b})},getLastModifiedTimes:function(a){net.apachegui.Main.getInstance().getActiveFileList(function(b){net.apachegui.Main.getInstance().getLastModifiedTimes(b,function(b){a(b.lastModifiedTimes)})})},
refreshModifiedTimes:function(){var a=this;this.getLastModifiedTimes(function(b){a.checkModifiedTimes=!0;a.lastModifiedTimes=b})},checkIfModifiedTimesHaveChanged:function(){var a=this;0!=this.lastModifiedTimes.length&&this.getLastModifiedTimes(function(b){var c=!1;a.lastModifiedTimes.length!=b.length&&(c=!0);for(var d=0;d<a.lastModifiedTimes.length&&!c;d++)0==b.filter(function(b){return a.lastModifiedTimes[d].file==b.file&&a.lastModifiedTimes[d].lastModifiedTime==b.lastModifiedTime?!0:!1}).length&&
(c=!0);c&&a.configTree.reload();a.lastModifiedTimes=b})},launchLastModifiedUpdateInterval:function(){var a=this;net.apachegui.Interval.setInterval(function(){a.checkModifiedTimes&&a.checkIfModifiedTimesHaveChanged()},5E3)}});net.apachegui.Util.setupSingletonInstance(net.apachegui.GlobalTree)});